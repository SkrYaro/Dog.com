{%extends "based/base.html"%}
{%block content%}
<!--Form-->
<div class="search container my-4">
  <form method="GET" class="p-4 border rounded-3 bg-light shadow-sm">

    <!-- –ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é -->
    <div class="mb-3">
      <label for="nameSearch" class="form-label fw-bold">–ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é</label>
      <input type="text" id="nameSearch" name="name"
             class="form-control"
             placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É..."
             value="{{ selected_name }}">
    </div>

    <!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—è -->
    <div class="mb-3">
      <label for="inputGroupSelect01" class="form-label fw-bold">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
      <select class="form-select" id="inputGroupSelect01" name="category">
        <option value="">–í—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>
        {% for category in categories %}
          <option value="{{ category.id }}"
            {% if category.id|stringformat:"s" == selected_category %}selected{% endif %}>
            {{ category.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <!-- –¢–µ–≥–∏ -->
    <div class="mb-3">
      <label class="form-label fw-bold">–¢–µ–≥–∏:</label>
      <div class="d-flex flex-wrap gap-2">
        {% for tag in tags %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="tag{{ tag.id }}"
                   name="tags" value="{{ tag.id }}"
                   {% if tag.id|stringformat:"s" in selected_tags %}checked{% endif %}>
            <label class="form-check-label" for="tag{{ tag.id }}">
              {{ tag.name }}
            </label>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ -->
    <div class="text-end">
      <button type="submit" class="btn btn-primary px-4">üîç –ü–æ—à—É–∫</button>
    </div>

  </form>
</div>
<!--EndForm-->

<!--Post Info-->
{% for post in posts %}
  {% if post.accepted %}
    <div class="card mb-4 shadow-sm">

      <!-- –ù–∞–∑–≤–∞ -->
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0">
          <a href="{% url 'post' post.id %}" class="text-white text-decoration-none">
            {{ post.name }}
          </a>
        </h5>
      </div>

      <div class="card-body">

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="mb-3 text-center">
          {% if post.postType == "video" %}
            <a href="{% url 'post' post.id %}">
              <video class="img-fluid rounded" style="max-width: 75%;" src="{{ post.video.url }}" controls></video>
            </a>
          {% elif post.postType == "img" %}
            <a href="{% url 'post' post.id %}">
              <img class="img-fluid rounded" style="max-width: 50%;" src="{{ post.img.url }}" alt="img">
            </a>
          {% elif post.postType == "react" %}
            <p class="fst-italic"><b>–†–µ–∞–∫—Ü—ñ—è:</b>{{ post.react }}</p>
          {% endif %}
        </div>

        <!-- –û–ø–∏—Å -->
        <p class="card-text"><strong>–û–ø–∏—Å:</strong>{{ post.description }}</p>

        <!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—è -->
        <p class="mb-1">
          {% if post.category %}
            <span class="badge bg-info text-dark">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: {{ post.category }}</span>
          {% else %}
            <span class="badge bg-secondary">–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –Ω–µ–º–∞—î</span>
          {% endif %}
        </p>

        <!-- –¢–µ–≥–∏ -->
        <div class="mt-2">
          <strong>–¢–µ–≥–∏:</strong>
          {% for tag in post.tags.all %}
            <span class="badge bg-light text-dark border">{{ tag.name }}</span>
          {% empty %}
            <span class="text-muted">–ù–µ–º–∞—î —Ç–µ–≥—ñ–≤</span>
          {% endfor %}
        </div>

      </div>
    </div>
  {% endif %}
{% endfor %}


{%endblock%}
